"use strict";if(typeof _pi_ad_agent==="undefined"){(function(){var a={config:{jquery_url:"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js",analytics_url:"https://www.google-analytics.com/analytics.js",jscookie_url:"https://learning.adbot.tw/js/js.cookie.min.js",fingerprintjs2_url:"https://learning.adbot.tw/js/fingerprint2.min.js",load_js_defaults:{dataType:"script",scriptCharset:"UTF-8"},lgif_url:"https://learning.adbot.tw/l.gif",ga_resource:"UA-89480192-1",ga_sample_rate:10},init:function(){a.debugMode()&&console.debug("_pi_ad_agent init");if(!a.isBot()){a.loadjQuery(function(){a.loadJs(function(){a.l_gif();if(a.getRandomInt(1,100)<=a.config.ga_sample_rate){a.pvTracking()}})})}else{a.debugMode()&&console.debug("bot... bye!")}},loadjQuery:function(c){if(!window.jQueryPi){a.debugMode()&&console.debug("no jQuery...");var b=document.createElement("script");b.type="text/javascript";b.src=a.config.jquery_url;b.setAttribute("charset","utf-8");document.getElementsByTagName("head")[0].appendChild(b);if(b.readyState){b.onreadystatechange=function(){if(b.readyState=="loaded"||b.readyState=="complete"){b.onreadystatechange=null;window.jQueryPi=window.jQuery.noConflict(true)}}}else{b.onload=function(){window.jQueryPi=window.jQuery.noConflict(true)}}}a.checkjQueryReady(function(){a.debugMode()&&console.debug("jQuery loaded");c()})},checkjQueryReady:function(b){if(window.jQueryPi&&window.jQueryPi.when){b()}else{window.setTimeout(function(){a.checkjQueryReady(b)},50)}},loadJs:function(b){a.debugMode()&&console.debug("loadJs start");var c=[a.config.jscookie_url,a.config.fingerprintjs2_url];var d=window.jQueryPi.map(c,function(f){var e=window.jQueryPi.extend({url:f},a.config.load_js_defaults);return window.jQueryPi.ajax(e)});window.jQueryPi.when.apply(window.jQueryPi,d).then(function(){a.debugMode()&&console.debug("loadJs done");b()})},debug:function(b){if(typeof localStorage!=="undefined"){b?localStorage.setItem("__pi_ad_agent_debug__",true):localStorage.removeItem("__pi_ad_agent_debug__")}else{alert("No localStorage supported")}},debugMode:function(){try{if(typeof localStorage!=="undefined"){return localStorage.getItem("__pi_ad_agent_debug__")!==null}}catch(b){return false}return false},pvTracking:function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;if(typeof __gaTracker!=="undefined"){__gaTracker(function(){window.ga=__gaTracker})}ga("create",a.config.ga_resource,"auto",{name:"adbot"});ga("adbot.send","pageview",{page:window.location.hostname+window.location.pathname});if(!(window.ga&&ga.create)){a.debugMode()&&console.debug("no ga load ga");window.jQueryPi.getScript(a.config.analytics_url,function(){})}a.debugMode()&&console.debug("ga pageview")},isBot:function(){return(/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent))},getRandomInt:function(c,b){return Math.floor(Math.random()*(b-c+1))+c},l_gif:function(){a.debugMode()&&console.debug("create gif");new Fingerprint2().get(function(c,d){var e=a.config.lgif_url+"?u="+encodeURIComponent(window.location.href)+"&ti="+encodeURIComponent(window.jQueryPi.trim(window.jQueryPi("title").text()))+"&fp="+c+"&ua="+encodeURIComponent(d[0].value);a.debugMode()&&console.debug(e);var b=document.createElement("img");b.src=e;b.onload=function(){b.parentNode.removeChild(b)};b.style="display:none";b.classList.add("lat_img");document.body.appendChild(b)})},l_iframe:function(){a.debugMode()&&console.debug("create iframe");new Fingerprint2().get(function(b,c){var d=a.config.liframe_url+"?u="+encodeURIComponent(window.location.href)+"&ti="+encodeURIComponent(window.jQueryPi.trim(window.jQueryPi("title").text()))+"&fp="+b+"&ua="+encodeURIComponent(c[0].value);a.debugMode()&&console.debug(d);window.jQueryPi("body").append(window.jQueryPi("<iframe/>").attr("style","display:none;").attr("class","lat_iframe").attr("src",d))})}};window._pi_ad_agent=a;a.init()})()}else{_pi_ad_agent.debugMode()&&console.debug("[IGNORE] initailized...")};